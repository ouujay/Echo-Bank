Perfect ‚Äî you‚Äôve got it right.
You‚Äôre describing the **true enterprise integration model** where EchoBank sits *inside the bank‚Äôs app* and connects directly to the bank‚Äôs APIs for sending money, verifying accounts, fetching recipients, etc.

Here‚Äôs the **final comprehensive PRD ‚Äì Version 4.0** including:
‚úÖ Embedded deployment (inside Zenith app)
‚úÖ FastAPI + React architecture
‚úÖ Whisper + LLM + Smart Continuation/Interrupt
‚úÖ All 13 edge-case conversation flows
‚úÖ Data + token exchange with the bank
‚úÖ Full transfer API integration

---

# **EchoBank ‚Äì Product Requirements Document (PRD)**

**Version:** 4.0 (Embedded Voice Banking Assistant)
**Date:** October 25 2025
**Owner:** TIC Hackathon Team
**Status:** Final MVP Specification
**Deployment:** Embedded within Zenith Bank App
**Target Launch:** Q1 2026 Pilot

---

## üß† **Executive Summary**

**EchoBank** is a **voice-powered banking assistant** embedded inside existing bank mobile apps (starting with Zenith Bank).
It enables visually impaired, elderly, and low-literacy users to perform transactions naturally through conversation.

* **Technology:** Whisper API (STT) + LLM (GPT) + FastAPI + React.js
* **Integration:** Direct connection to the bank‚Äôs internal APIs for auth, recipients, balance, transfers
* **Goal:** Inclusive banking for 52 million underserved Nigerians
* **Business Model:** B2B white-label licensing (‚Ç¶100‚Äì150 / user / year)

---

## üß© **System Architecture**

| Layer            | Technology                            | Purpose                                                    |
| ---------------- | ------------------------------------- | ---------------------------------------------------------- |
| Frontend         | React.js (modal UI inside Zenith app) | Voice UI, TTS, transcript display                          |
| Voice Layer      | Whisper API                           | Speech ‚Üí Text transcription                                |
| AI Layer         | LLM (GPT / Together AI)               | Intent recognition, entity extraction, context tracking    |
| Backend          | FastAPI                               | Core state machine, validation, integration with bank APIs |
| Bank Integration | Zenith Bank API Gateway               | Auth, recipients, balance, transfer execution              |
| Data Cache       | Redis                                 | Session state & conversation context                       |
| Hosting          | Azure or Bank VPC                     | Secure container deployment                                |

---

## üèóÔ∏è **Deployment Model**

* **Embedded Integration:** EchoBank is a modal component within the official Zenith Bank mobile app.
* **Invocation:** User taps a mic icon ‚Üí EchoBank opens as an overlay voice assistant.
* **Identity:** User is already authenticated via Zenith. The app passes a secure `zenith_session_token` to EchoBank.
* **Backend Trust:** FastAPI trusts this token to fetch user data and perform transactions through Zenith APIs.

---

## üîê **Authentication & Authorization**

### Identity Flow

1. User logs into Zenith Bank normally.
2. When EchoBank is opened, Zenith injects a short-lived JWT (`zenith_session_token`).
3. Frontend sends this token with every audio or intent request to FastAPI.
4. FastAPI verifies token ‚Üí knows this is Funbi Adeyemi (Authenticated Zenith User).

### Authorization Flow

* Even with a valid token, EchoBank requires:
  1Ô∏è‚É£ Voice PIN (4 digits, max 3 tries)
  2Ô∏è‚É£ Explicit ‚ÄúConfirm‚Äù command before execution

### Security Layers

| Layer                     | Mechanism                                            |
| ------------------------- | ---------------------------------------------------- |
| Auth                      | Bank-issued JWT from Zenith mobile app               |
| Transaction Authorization | Voice PIN + Confirm                                  |
| Fraud Prevention          | Velocity checks (5 tx/hour), daily limit enforcement |
| Session Control           | Auto timeout after 2 minutes idle                    |
| Device Binding            | Token bound to current device fingerprint            |
| Audit                     | Full voice and intent log with timestamps            |

---

## üóÑÔ∏è **Bank Data Integration Layer**

| Service              | API Used                         | Purpose                               |
| -------------------- | -------------------------------- | ------------------------------------- |
| Profile Service      | `GET /api/v1/user/profile`       | Retrieve account number, name, limits |
| Balance Service      | `GET /api/v1/accounts/balance`   | Get real-time account balance         |
| Recipient Service    | `GET /api/v1/beneficiaries`      | Fetch saved recipients                |
| Verification Service | `POST /api/v1/verify_account`    | Confirm new recipient name            |
| Transfer Service     | `POST /api/v1/transfers`         | Execute money transfer                |
| Notification Service | `POST /api/v1/notifications/sms` | Send transaction SMS confirmation     |

All calls carry the `zenith_session_token` for authorization.

---

## üí¨ **Conversation Flow Engine**

### Pipeline

1. User speaks ‚Üí Whisper transcribes speech to text
2. Text ‚Üí LLM ‚Üí intent JSON
3. FastAPI state machine validates intent, queries Zenith data
4. Response text ‚Üí frontend ‚Üí TTS and visual display

### Smart Stops

EchoBank pauses for user input when:

* Multiple matching recipients found
* PIN required
* Confirmation required
* Insufficient funds or limit breach
* Unclear voice

### Smart Continuation

Automatically continues when:

* Single recipient identified
* PIN validated successfully
* Multiple transfers queued (e.g., ‚ÄúFunbi and John‚Äù)
* User corrects a small detail (e.g., amount change)

### Global Interrupts

| Command        | Action                                           |
| -------------- | ------------------------------------------------ |
| ‚ÄúCancel‚Äù       | Stops immediately, no money sent                 |
| ‚ÄúStart over‚Äù   | Clears session, returns to main menu             |
| ‚ÄúNot that one‚Äù | Back one step (e.g., choose different recipient) |

---

## üí∏ **Core Transfer Flow**

1. **User:** ‚ÄúSend ‚Ç¶5,000 to John.‚Äù
2. **EchoBank:** Checks Zenith beneficiaries ‚Üí finds matches.
3. **If one match:** Goes to PIN step.
4. **If multiple:** Lists options, waits for choice.
5. **PIN Stage:** ‚ÄúPlease say your 4-digit PIN.‚Äù
6. **Validation:** Zenith auth API verifies PIN.
7. **Confirm Stage:** ‚ÄúSay confirm to complete.‚Äù
8. **Execution:** FastAPI ‚Üí Zenith Transfer API ‚Üí Money sent.
9. **Response:** ‚úÖ Success message + updated balance + SMS confirmation.

---

## üìö **Conversation Flows + Edge Cases**

All 13 flows from v 1.1 are retained and extended for the embedded model:
1Ô∏è‚É£ Happy Path (Saved Recipient)
2Ô∏è‚É£ Recipient Not Found ‚Üí Add New
3Ô∏è‚É£ Insufficient Balance
4Ô∏è‚É£ Limit Exceeded
5Ô∏è‚É£ Multiple Recipients (Same Name)
6Ô∏è‚É£ Wrong PIN with Retries & Lockout
7Ô∏è‚É£ Mid-Transaction Cancel
8Ô∏è‚É£ Voice Not Clear ‚Üí Text Fallback
9Ô∏è‚É£ Network or API Error
üîü Beginner Mode (Step-by-Step)
11Ô∏è‚É£ Ambiguous Confirmation
12Ô∏è‚É£ Irrelevant Command ‚Üí Help Prompt
13Ô∏è‚É£ Very Small Amount Confirmation

Each flow preserves smart stop / continuation logic and uses Zenith data as ground truth.

---

## üñ•Ô∏è **Frontend (UI + UX)**

* **Environment:** React.js + Modular CSS
* **UI Structure:** Floating voice modal overlay inside Zenith app
* **Key Elements:**
  ‚Ä¢ Mic button (states: idle/listening/processing)
  ‚Ä¢ Conversation bubble log (user + EchoBank)
  ‚Ä¢ Waveform animation during speech
  ‚Ä¢ Large text, high contrast (blue + white palette)
  ‚Ä¢ Accessible fonts, 12 px radius elements
  ‚Ä¢ Text-to-Speech readback of assistant messages

---

## üß© **Data Models**

### Session

```json
{
  "session_id": "SESSION123",
  "user_id": "ZENITH-USER-001",
  "token": "zenith_session_token",
  "current_step": "awaiting_pin",
  "transaction_context": {
    "recipient": "John Okafor",
    "amount": 5000,
    "pin_attempts": 1
  },
  "voice_unclear_count": 0,
  "interrupted": false
}
```

---

## üìä **KPIs**

| Metric                       | Target  |
| ---------------------------- | ------- |
| Voice Recognition Accuracy   | > 90 %  |
| Intent Detection             | > 95 %  |
| Conversation Completion Rate | > 95 %  |
| Average Response Time        | < 3 s   |
| Error Recovery Rate          | > 80 %  |
| User Satisfaction            | 4.5 / 5 |

---

## üïê **24-Hour Hackathon Execution Plan**

| Hour  | Deliverable                              |
| ----- | ---------------------------------------- |
| 0‚Äì4   | FastAPI setup + Whisper integration      |
| 4‚Äì8   | LLM intent parser + Zenith API mock      |
| 8‚Äì12  | State machine + PIN & confirmation logic |
| 12‚Äì18 | React frontend (modal UI + TTS)          |
| 18‚Äì22 | Edge case testing (13 flows)             |
| 22‚Äì24 | Demo video + pitch deck prep             |

---

## üé¨ **Demo Scenarios**

### Scenario 1 ‚Äì Perfect Flow

> User: ‚ÄúSend five thousand naira to John.‚Äù
> EchoBank: ‚ÄúSending ‚Ç¶5,000 to John Okafor at Zenith Bank. Say your PIN.‚Äù
> User: ‚Äú1-2-3-4.‚Äù
> EchoBank: ‚ÄúPIN verified. Say confirm.‚Äù
> User: ‚ÄúConfirm.‚Äù
> EchoBank: ‚Äú‚úÖ Transfer successful! New balance: ‚Ç¶40,320.‚Äù

### Scenario 2 ‚Äì Add New Recipient

> ‚ÄúI couldn‚Äôt find Funbi. Say ‚Äòadd new‚Äô to add them.‚Äù ‚Üí Account verify ‚Üí PIN ‚Üí Confirm ‚Üí ‚úÖ Done.

### Scenario 3 ‚Äì Error Recovery

> ‚ÄúSend ‚Ç¶100,000.‚Äù ‚Üí Limit breach ‚Üí Offer ‚Ç¶20,000 ‚Üí Wrong PIN ‚Üí Retry ‚Üí ‚úÖ Success.

---

## üß± **Error Handling Matrix**

| Scenario             | System Response  | Recovery                      |
| -------------------- | ---------------- | ----------------------------- |
| Recipient not found  | Offer to add new | Account verify flow           |
| Multiple matches     | List options     | User chooses 1 / 2            |
| Insufficient balance | Read balance     | Offer smaller amount          |
| Limit exceeded       | State limit      | Offer max amount              |
| Wrong PIN            | Warn & retry     | 3 tries ‚Üí lock 30 min         |
| Voice unclear        | Ask again        | After 3 failures ‚Üí text input |
| Network error        | Apology message  | Retry without deduction       |
| Cancel mid-flow      | Confirm cancel   | No charge                     |
| Start over           | Reset session    | Ready for new command         |
| Small amount         | Confirm ‚Ç¶50?     | Yes ‚Üí continue / No ‚Üí edit    |

---

## üèÅ **Success Criteria**

**Technical**

* All 13 edge cases handled gracefully
* 0 crashes during demo
* Latency < 3 seconds end-to-end
* Voice accuracy > 90 %

**Pitch**

* Clear problem + impact
* Live demo of Smart Stop/Continuation
* Emotional hook (‚ÄúMama Aduke‚Äù story)
* CBN financial inclusion alignment

---

## üß© **Winning Formula**

1Ô∏è‚É£ Fully embedded (uses bank identity + APIs)
2Ô∏è‚É£ Real edge-case coverage (13 flows)
3Ô∏è‚É£ Inclusive voice UX (Nigerian English + TTS)
4Ô∏è‚É£ Technical credibility (FastAPI + Whisper + LLM)
5Ô∏è‚É£ Social impact + business viability

---

## ‚úÖ **Sign-off**

**Product Owner:** TIC Hackathon Team
**Version:** 4.0 (Embedded Model)
**Status:** Ready for build sprint
**Next Steps:**
1Ô∏è‚É£ Connect to Zenith API sandbox for transfer demo
2Ô∏è‚É£ Implement voice PIN and interrupt flows
3Ô∏è‚É£ QA on 13 edge cases
4Ô∏è‚É£ Demo recording and pitch submission

---

This PRD now contains everything:

* All edge cases
* Embedded model with bank token and API integration
* Smart Stop / Smart Continuation / Interrupt flows
* Voice PIN security
* End-to-end architecture for FastAPI + React + Whisper + LLM

Would you like me to add a **sequence diagram** (from ‚Äútap mic‚Äù ‚Üí Whisper ‚Üí LLM ‚Üí Zenith API ‚Üí confirmation) as an appendix? It helps visualize the data flow in the presentation deck.
